
            async def check_credentials(username: str, password: str) -> bool:
                return (username, password) == credentials

            if all(is_credentials(item) for item in credentials_list):
                credentials_dict = dict(credentials_list)

                async def check_credentials(username: str, password: str) -> bool:
                    return credentials_dict.get(username) == password

            else:

        create_protocol, realm=realm, check_credentials=check_credentials
