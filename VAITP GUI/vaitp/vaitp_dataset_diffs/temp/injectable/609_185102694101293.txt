proc password_pwhash_str*(password: string): string =
crypto_pwhash_str(password)
proc password_needs_rehashing*(password: string): bool =
crypto_pwhash_str_needs_rehash(password) != 0
proc verify_password(password, pwhash: string): bool =
return crypto_pwhash_str_verify(pwhash, password)
let authenticated = verify_password(password, user.hash)
if password_needs_rehashing(user.hash):
user.hash = password_pwhash_str(password)
self.backend.set_user(user)
let pwhash = password_pwhash_str(password)
hash: pwhash,
user.hash = password_pwhash_str(password)
let pwhash = password_pwhash_str(password)
hash: pwhash,
let pwhash = password_pwhash_str(password)
hash: pwhash,
user.hash = password_pwhash_str(password)
