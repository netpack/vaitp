import is_safe_url
import ShareForm
def validate_redirect_url(url):
"""
Returns a URL is safe to redirect to.
If url is a different host, not in settings.REDIRECT_ALLOWED_HOSTS
we return webclient index URL.
"""
if not is_safe_url(url, allowed_hosts=settings.REDIRECT_ALLOWED_HOSTS):
url = reverse("webindex")
return url
else:
url = validate_redirect_url(url)
url = validate_redirect_url(url)
context["member_of_groups"] = conn.getEventContext().memberOfGroups
