"wagtail_2fa_auth",
"wagtailadmin_login",
"wagtailadmin_logout",
]
_allowed_url_names_no_device = [
user_has_device = django_otp.user_has_device(user, confirmed=True)
if request.path in self._get_allowed_paths(user_has_device):
def _get_allowed_paths(self, has_device):
"""Return the paths the user may visit when not verified via otp.
If the user already has a registered device, return a limited set of
paths to prevent them or listing devices to prevent them
or listing devices.
allowed_url_names = self._allowed_url_names
if not has_device:
allowed_url_names = self._allowed_url_names_no_device
for route_name in allowed_url_names:
