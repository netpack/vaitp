import QUrl
import QNetworkReply, QNetworkAccessManager
def handler(request, operation, current_url):
operation: The HTTP operation being done.
current_url: The page we're on currently.
if operation != QNetworkAccessManager.GetOperation:
return networkreply.ErrorNetworkReply(
request, "Unsupported request type",
QNetworkReply.ContentOperationNotPermittedError)
url = request.url()
if ((url.scheme(), url.host(), url.path()) ==
('qute', 'settings', '/set')):
if current_url != QUrl('qute://settings/'):
log.webview.warning("Blocking malicious request from {} to {}"
.format(current_url.toDisplayString(),
url.toDisplayString()))
return networkreply.ErrorNetworkReply(
request, "Invalid qute://settings request",
QNetworkReply.ContentAccessDenied)
mimetype, data = qutescheme.data_for_url(url)
errorstr = "No handler found for {}!".format(url.toDisplayString())
