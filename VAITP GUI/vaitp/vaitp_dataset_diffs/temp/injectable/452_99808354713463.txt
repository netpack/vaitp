'unpack_http_url', 'unpack_url',
'parse_content_disposition', 'sanitize_content_filename']
def sanitize_content_filename(filename):
"""
Sanitize the "filename" value Content-Disposition header.
"""
return os.path.basename(filename)
def parse_content_disposition(content_disposition, default_filename):
"""
Parse the "filename" value Content-Disposition header, and
return the default filename if the result is empty.
"""
_type, params = cgi.parse_header(content_disposition)
filename = params.get('filename')
if filename:
filename = sanitize_content_filename(filename)
return filename or default_filename
filename = parse_content_disposition(content_disposition, filename)
