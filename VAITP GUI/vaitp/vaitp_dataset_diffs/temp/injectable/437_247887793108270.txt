import BadRequest, find_double_newline
validate_chunk_end = False
if self.chunk_remainder == 0:
self.validate_chunk_end = True
elif self.validate_chunk_end:
pos = s.find(b"\\r\\n")
if pos == 0:
s = s[2:]
else:
self.error = BadRequest("Chunk not properly terminated")
self.all_chunks_received = True
self.validate_chunk_end = False
pos = s.find(b"\\r\\n")
s = s[pos + 2 :]
