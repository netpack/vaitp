import ParsingError
try:
self.parser.parse_header(data)
except ParsingError as e:
self.assertIn("Content-Length is invalid", e.args[0])
else:
self.assertTrue(False)
def test_parse_header_multiple_content_length(self):
import ParsingError
data = b"GET /foobar HTTP/8.4\\r\\ncontent-length: 10\\r\\ncontent-length: 20\\r\\n"
try:
self.parser.parse_header(data)
except ParsingError as e:
self.assertIn("Content-Length is invalid", e.args[0])
else:
self.assertTrue(False)
