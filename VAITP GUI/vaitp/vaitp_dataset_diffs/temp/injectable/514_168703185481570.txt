import werkzeug.exceptions
def get_paths(root: str, sub_path: str) \\
-> typing.Tuple[pathlib.Path, pathlib.Path]:
base_path = flask.safe_join(root, sub_path)
data_file = pathlib.Path(base_path + ".data")
metadata_file = pathlib.Path(base_path + ".meta")
def get_info(path: str) -> typing.Tuple[
data_file, metadata_file = get_paths(app.config["DATA_ROOT"], path)
data_file, metadata_file = get_paths(app.config["DATA_ROOT"], path)
except werkzeug.exceptions.NotFound:
data_file.parent.mkdir(parents=True, exist_ok=True, mode=0o770)
data_file, metadata = get_info(path)
except (OSError, werkzeug.exceptions.NotFound):
data_file, metadata = get_info(path)
except (OSError, werkzeug.exceptions.NotFound):
