import server
MAX_REQUEST_SIZE = 512 * 1024
except Exception:
def connectionLost(self, reason=connectionDone) -> None:
class SizeLimitingRequest(server.Request):
def handleContentChunk(self, data):
if self.content.tell() + len(data) > MAX_REQUEST_SIZE:
logger.info(
"Aborting connection from %s because the request exceeds maximum size",
self.client.host)
self.transport.abortConnection()
return
return super().handleContentChunk(data)
