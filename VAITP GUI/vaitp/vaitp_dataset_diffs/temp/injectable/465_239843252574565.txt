def test_cwe93_inject_crlf():
http = httplib2.Http()
with tests.server_reflect() as uri:
danger_url = urllib.parse.urljoin(
uri, "?q= HTTP/1.1\\r\\ninjected: attack\\r\\nignore-http:"
)
response, content = http.request(danger_url, "GET")
assert response.status == 200
req = tests.HttpRequest.from_bytes(content)
assert req.headers.get("injected") is None
def test_inject_space():
http = httplib2.Http()
with tests.server_reflect() as uri:
danger_url = urllib.parse.urljoin(uri, "?q= HTTP/1.1\\r\\nignore-http:")
response, content = http.request(danger_url, "GET")
assert response.status == 200
req = tests.HttpRequest.from_bytes(content)
assert req.uri == "/?q=%20HTTP/1.1%0D%0Aignore-http:"
