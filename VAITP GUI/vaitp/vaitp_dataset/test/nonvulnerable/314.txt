"def test_download_http_url__no_directory_traversal(tmpdir):    """    Test that directory traversal doesn't happen on download when the    Content-Disposition header contains a filename with a ".." path part.    """    mock_url = 'http://www.example.com/whatever.tgz'    contents = b'downloaded'    link = Link(mock_url)    session = Mock()    resp = MockResponse(contents)    resp.url = mock_url    resp.headers = {        # Set the content-type to a random value to prevent        # mimetypes.guess_extension from guessing the extension.        'content-type': 'random',        'content-disposition': 'attachment;filename="../out_dir_file"'    }    session.get.return_value = resp    download_dir = tmpdir.join('download')    os.mkdir(download_dir)    file_path, content_type = _download_http_url(        link,        session,        download_dir,        hashes=None,        progress_bar='on',    )    # The file should be downloaded to download_dir.    actual = os.listdir(download_dir)    assert actual == ['out_dir_file']"