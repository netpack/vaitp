"    def connectionMade(self):        method = _ensureValidMethod(getattr(self.factory, 'method', b'GET'))        self.sendCommand(method, _ensureValidURI(self.factory.path))        if self.factory.scheme == b'http' and self.factory.port != 80:            host = self.factory.host + b':' + intToBytes(self.factory.port)        elif self.factory.scheme == b'https' and self.factory.port != 443:            host = self.factory.host + b':' + intToBytes(self.factory.port)        else:            host = self.factory.host        self.sendHeader(b'Host', self.factory.headers.get(b"host", host))        self.sendHeader(b'User-Agent', self.factory.agent)        data = getattr(self.factory, 'postdata', None)        if data is not None:            self.sendHeader(b"Content-Length", intToBytes(len(data)))        cookieData = []        for (key, value) in self.factory.headers.items():            if key.lower() not in self._specialHeaders:                # we calculated it on our own                self.sendHeader(key, value)            if key.lower() == b'cookie':                cookieData.append(value)        for cookie, cookval in self.factory.cookies.items():            cookieData.append(cookie + b'=' + cookval)        if cookieData:            self.sendHeader(b'Cookie', b'; '.join(cookieData))        self.endHeaders()        self.headers = {}        if data is not None:            self.transport.write(data)"