"    def _require_verified_user(self, request):        user = request.user        if not settings.WAGTAIL_2FA_REQUIRED:            # If two factor authentication is disabled in the settings            return False        if not user.is_authenticated:            return False        # If the user has no access to the admin anyway then don't require a        # verified user here        if not (            user.is_staff            or user.is_superuser            or user.has_perms(["wagtailadmin.access_admin"])        ):            return False        # Allow the user to a fixed number of paths when not verified        user_has_device = django_otp.user_has_device(user, confirmed=True)        if request.path in self._get_allowed_paths(user_has_device):            return False        # For all other cases require that the user is verfied via otp        return True"