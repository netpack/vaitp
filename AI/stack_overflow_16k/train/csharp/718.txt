"fast way to find if ipv6 belongs to network range i've created a simple script to detect if an ip is in a fixed number of networks (if ip is part of cidr ip range). unfortunately the performance goal was not met. 50 checks(for loop) if an ipv6 belongs to one one of 250 networks takes 55ms, which is way slower than what is expected. i supply a short version of the program and code in hope of finding a more performant solution. i used https://github.com/lduchosal/ipnetwork library because i didn't know how to perform bitwise shifts on 128 bits of data needed to store ipv6...i don't include a large block of ipv4s, because ipv4 lookups are 3x faster. ipv6 were duplicated a few times to simulate large block..thats how you call it:.. using system;. using system.globalization;. using system.net;.. namespace cidr_lookup. {.  internal class program..  {.    public static void main(string[] args){..      // initilizes static cache by triggering a call to static constructor. i and jk arrays are not used.      ipnetwork[] i = cidrlookup.subnetcache;.      ipnetwork[] jk = cidrlookup.subnetcache6;.      console.writeline(jk.length);...      var watch = system.diagnostics.stopwatch.startnew();.      bool isin = false;.      for (int j = 0; j &lt; 50; j++){.        isin= cidrlookup.ipinrange(ipaddress.parse(""2a03:2880::1"").getaddressbytes());.      }..      watch.stop();.      var elapsedms = watch.elapsedmilliseconds;.      console.writeline(""elapsed: ""+ elapsedms);.   }. }.}...this is the class code:..using system;.using system.net;.using system.net.sockets;.using system.numerics;..namespace cidr_lookup.{.  public partial class cidrlookup.  {.    public static ipnetwork[] subnetcache;.    public static ipnetwork[] subnetcache6;..    static cidrlookup(){.      subnetcache = cidrlookup.createsubnets(_ipranges);.      subnetcache6 = cidrlookup.createsubnets(_ipranges6);.    }....    public static bool ipinrange(byte[] ipbytes){..      ipaddress ip = new ipaddress(ipbytes);..        if (ip.addressfamily  == addressfamily.internetwork){.          foreach (var subnet in subnetcache){.            bool isin = subnet.contains(ip);.            if (isin){.              return true;.            }.          }.        }.        else{.          foreach (var subnet in subnetcache6){.            bool isin = subnet.contains(ip);.            if (isin){.              return true;.            }.          }.        }..      return false;.    }..    public static ipnetwork[] createsubnets(string ipranges){.      string[] iprangesarray = ipranges.split('n');.      ipnetwork[] table = new ipnetwork[iprangesarray.length];..      for (int i = 0; i &lt; iprangesarray.length; i++){.        table[i] = ipnetwork.parse(iprangesarray[i]);.      }..      return table;.    }..    public static string ipranges.    {.      get { return _ipranges; }.      set { _ipranges = value; }.    }..    public static string ipranges6.    {.      get { return _ipranges6; }.      set { _ipranges6 = value; }.    }...    private static string _ipranges6 = @""2604:ca00:f001::/48.    2604:ca00:f004::/48.    2402:9800:8001:0:0:0:0:0/48.    2604:ca00:f009::/48.    2604:ca00:9::/48.    2604:ca00:f008::/48.    2604:ca00:8::/48.    2604:ca00:1a0::/43.    2604:ca00:f::/48.    2604:ca00:d000::/48.    2604:ca00:f000::/48.    2605:ef80:240::/42.    2605:ef80:300::/40.    2605:ef80:400::/42.    2605:ef80:600::/40.    2605:ef80:900::/40.    2607:f8b0:4000::/48.    2a00:79e1:abc::/46.    2a03:ace0:100::/40.    2a03:ace0:200::/40.    2a03:ace0:300::/40.    2605:ef80::/32.    2a03:ace0::/32.    2605:ef80::/42.    2605:ef80:100::/42.    2605:ef80:140::/42.    2605:ef80:180::/42.    2605:ef80:1c0::/42.    2605:ef80:40::/42.    2605:ef80:80::/42.    2605:ef80:c0::/42.    2605:59c0::/32.    2604:ca00::/32.    2604:ca00:f001::/48.    2604:ca00:f004::/48.    2402:9800:8001:0:0:0:0:0/48.    2604:ca00:f009::/48.    2604:ca00:9::/48.    2604:ca00:f008::/48.    2604:ca00:8::/48.    2604:ca00:1a0::/43.    2604:ca00:f::/48.    2604:ca00:d000::/48.    2604:ca00:f000::/48.    2605:ef80:240::/42.    2605:ef80:300::/40.    2605:ef80:400::/42.    2605:ef80:600::/40.    2605:ef80:900::/40.    2607:f8b0:4000::/48.    2a00:79e1:abc::/46.    2a03:ace0:100::/40.    2a03:ace0:200::/40.    2a03:ace0:300::/40.    2605:ef80::/32.    2a03:ace0::/32.    2605:ef80::/42.    2605:ef80:100::/42.    2605:ef80:140::/42.    2605:ef80:180::/42.    2605:ef80:1c0::/42.    2605:ef80:40::/42.    2605:ef80:80::/42.    2605:ef80:c0::/42.    2605:59c0::/32.    2604:ca00::/32.    2604:ca00:f001::/48.    2604:ca00:f004::/48.    2402:9800:8001:0:0:0:0:0/48.    2604:ca00:f009::/48.    2604:ca00:9::/48.    2604:ca00:f008::/48.    2604:ca00:8::/48.    2604:ca00:1a0::/43.    2604:ca00:f::/48.    2604:ca00:d000::/48.    2604:ca00:f000::/48.    2605:ef80:240::/42.    2605:ef80:300::/40.    2605:ef80:400::/42.    2605:ef80:600::/40.    2605:ef80:900::/40.    2607:f8b0:4000::/48.    2a00:79e1:abc::/46.    2a03:ace0:100::/40.    2a03:ace0:200::/40.    2a03:ace0:300::/40.    2605:ef80::/32.    2a03:ace0::/32.    2605:ef80::/42.    2605:ef80:100::/42.    2605:ef80:140::/42.    2605:ef80:180::/42.    2605:ef80:1c0::/42.    2605:ef80:40::/42.    2605:ef80:80::/42.    2605:ef80:c0::/42.    2605:59c0::/32.    2604:ca00::/32.    2604:ca00:f001::/48.    2604:ca00:f004::/48.    2402:9800:8001:0:0:0:0:0/48.    2604:ca00:f009::/48.    2604:ca00:9::/48.    2604:ca00:f008::/48.    2604:ca00:8::/48.    2604:ca00:1a0::/43.    2604:ca00:f::/48.    2604:ca00:d000::/48.    2604:ca00:f000::/48.    2605:ef80:240::/42.    2605:ef80:300::/40.    2605:ef80:400::/42.    2605:ef80:600::/40.    2605:ef80:900::/40.    2607:f8b0:4000::/48.    2a00:79e1:abc::/46.    2a03:ace0:100::/40.    2a03:ace0:200::/40.    2a03:ace0:300::/40.    2605:ef80::/32.    2a03:ace0::/32.    2605:ef80::/42.    2605:ef80:100::/42.    2605:ef80:140::/42.    2605:ef80:180::/42.    2605:ef80:1c0::/42.    2605:ef80:40::/42.    2605:ef80:80::/42.    2605:ef80:c0::/42.    2605:59c0::/32.    2604:ca00::/32.    2604:ca00:f001::/48.    2604:ca00:f004::/48.    2402:9800:8001:0:0:0:0:0/48.    2604:ca00:f009::/48.    2604:ca00:9::/48.    2604:ca00:f008::/48.    2604:ca00:8::/48.    2604:ca00:1a0::/43.    2604:ca00:f::/48.    2604:ca00:d000::/48.    2604:ca00:f000::/48.    2605:ef80:240::/42.    2605:ef80:300::/40.    2605:ef80:400::/42.    2605:ef80:600::/40.    2605:ef80:900::/40.    2607:f8b0:4000::/48.    2a00:79e1:abc::/46.    2a03:ace0:100::/40.    2a03:ace0:200::/40.    2a03:ace0:300::/40.    2605:ef80::/32.    2a03:ace0::/32.    2605:ef80::/42.    2605:ef80:100::/42.    2605:ef80:140::/42.    2605:ef80:180::/42.    2605:ef80:1c0::/42.    2605:ef80:40::/42.    2605:ef80:80::/42.    2605:ef80:c0::/42.    2605:59c0::/32.    2604:ca00::/32.    2604:ca00:f001::/48.    2604:ca00:f004::/48.    2402:9800:8001:0:0:0:0:0/48.    2604:ca00:f009::/48.    2604:ca00:9::/48.    2604:ca00:f008::/48.    2604:ca00:8::/48.    2604:ca00:1a0::/43.    2604:ca00:f::/48.    2604:ca00:d000::/48.    2604:ca00:f000::/48.    2605:ef80:240::/42.    2605:ef80:300::/40.    2605:ef80:400::/42.    2605:ef80:600::/40.    2605:ef80:900::/40.    2607:f8b0:4000::/48.    2a00:79e1:abc::/46.    2a03:ace0:100::/40.    2a03:ace0:200::/40.    2a03:ace0:300::/40.    2605:ef80::/32.    2a03:ace0::/32.    2605:ef80::/42.    2605:ef80:100::/42.    2605:ef80:140::/42.    2605:ef80:180::/42.    2605:ef80:1c0::/42.    2605:ef80:40::/42.    2605:ef80:80::/42.    2605:ef80:c0::/42.    2605:59c0::/32.    2604:ca00::/32.    2604:ca00:f001::/48.    2604:ca00:f004::/48.    2402:9800:8001:0:0:0:0:0/48.    2604:ca00:f009::/48.    2604:ca00:9::/48.    2604:ca00:f008::/48.    2604:ca00:8::/48.    2604:ca00:1a0::/43.    2604:ca00:f::/48.    2604:ca00:d000::/48.    2604:ca00:f000::/48.    2605:ef80:240::/42.    2605:ef80:300::/40.    2605:ef80:400::/42.    2605:ef80:600::/40.    2605:ef80:900::/40.    2607:f8b0:4000::/48.    2a00:79e1:abc::/46.    2a03:ace0:100::/40.    2a03:ace0:200::/40.    2a03:ace0:300::/40.    2605:ef80::/32.    2a03:ace0::/32.    2605:ef80::/42.    2605:ef80:100::/42.    2605:ef80:140::/42.    2605:ef80:180::/42.    2605:ef80:1c0::/42.    2605:ef80:40::/42.    2605:ef80:80::/42.    2605:ef80:c0::/42.    2605:59c0::/32"";..    private static string _ipranges = @""1.1.1.1.2.2.2.2.3.3.3.3"";.  }.}"
