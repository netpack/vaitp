"priorityqueue does not sort, sometime throw exception i run requestor thread..task t = new task(s1, s2, c, p);..requestor req = new requestor(queue, t);.req.start();...it add task to queue and run service thread..queue.add(task); // my class..service ser = new service(queue);.ser.start();...add method..public void add(task t) {.    synchronized (mutex) {.        queue.add(t); // priorityqueue&lt;task&gt;..        list.clear(); // defaultlistmodel..        for (task ta : queue).            list.addelement(ta);.    }.}...service's run method..    task = queue.pop(); // my class.....    queue.add(task);...pop method..public task pop() {.    synchronized (mutex) {.        arraylist&lt;task&gt; al = new arraylist&lt;task&gt;();..        task tmp = queue.remove();.        al.add(tmp);..        while (tmp.isfinish() &amp;&amp; !queue.isempty()) {.            tmp = queue.remove();.            al.add(tmp);.        }..        al.remove(al.size()-1);..        for (task t : al) {.            queue.add(t);.        }..        list.clear();..        for (task ta : queue).            list.addelement(ta);..        return tmp;.    }.}...queue var is..    comparator&lt;task&gt; cmp = new taskcomparator();..    queue = new priorityqueue&lt;task&gt;(20, cmp);...comparator.. public class taskcomparator implements comparator&lt;task&gt; {..@override.public int compare(task o1, task o2) {.    return o1.getpriority() - o2.getpriority();.}..}...generally this priority queue sort randomly, some time i can see ..exception in thread ""awt-eventqueue-0"" blank.lang.arrayindexoutofboundsexception: 1 &gt;= 0.at blank.util.vector.elementat(vector.blank:427).at blankx.swing.defaultlistmodel.getelementat(defaultlistmodel.blank:70).......----edit.gui..private queue queue;.....    _add.addactionlistener(new actionlistener() {..        @override.        public void actionperformed(actionevent e) {.....            task t = new task(s1, s2, c, p);..            requestor req = new requestor(queue, t);.            req.start();.        }.    });.....    jscrollpane scrollpane = new jscrollpane();.    contentpane.add(scrollpane, borderlayout.center);..    defaultlistmodel model = new defaultlistmodel();..    jlist _list = new jlist(model);.    scrollpane.setviewportview(_list);..    queue = new queue(model);...-- edit..i implements comparable to task class. if i return 1 it always add new o elements on bottom, when i return -1 it always add new element on top, but when ..@override.public int compareto(task o) {.    if (pr == o.getpriority()).        return 0;.    else if (pr &gt; o.getpriority()).        return 1;.    else.        return -1;.}...it sort as it want"
