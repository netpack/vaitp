"parallel processing and get two error:there is already an open datareader associated whit this connection which must be closet first & i have this code :..    string mainurlmarkafoni = ""https://www.markafoni.com"";.        list&lt;string&gt; menulinksmarkafoni = new list&lt;string&gt;();.        datatable butikstablemarkafoni = new datatable();.        datatable productstablemarkafoni = new datatable();.        datatable categorytablemarkafoni = new datatable();.        private int menucountermarkafoni = 0;.        int butikcountermarkafoni = 0;.        bool islockedmarkafonibutik = false;.        int categorycountermarkafoni = 0;.        bool islockedmarkafonicategory = true;..private void gethtmlmarkafoni()...    {.        {.            con2 = new mysqlconnection(connetionstring);...            var doc = webget.load(mainurlmarkafoni);..            //select first tag a of top menu.            foreach (var a in doc.documentnode.selectnodes(""//*[contains(@class,'first_line')]"")).            {.                var href = a.attributes[""href""].value;.                if (href != ""/"" &amp;&amp; href != ""/okul/"").                    menulinksmarkafoni.add(a.attributes[""href""].value);.            }...            foreach (var menuurl in menulinksmarkafoni).            {.                string url = mainurlmarkafoni + menuurl;..                task.factory.startnew(() =&gt;.                {.                    doc = webget.load(url);..                    //***********start get campaign_big div of campaigns***********//.                    htmlnodecollection campaignbig = doc.documentnode.selectnodes(""//div[contains(@class,'campaign_big')]"");.                    if (campaignbig != null).                    {..                        foreach (htmlnode element in campaignbig).                        {..                            //get butiks attribute values.                            var butikurl = element.selectsinglenode("".//a[@class='campaign-link-big']"").getattributevalue(""href"", null);.                            var butiktitle = element.selectsinglenode("".//div[contains(@class,'campaign_name_big')]"").innertext;.                            var butikimg = element.selectsinglenode("".//div/a/img"").getattributevalue(""src"", null);.                            var butikendtime = element.selectsinglenode("".//div[contains(@class,'campaign_overlay')]"").getattributevalue(""data-seconds"", null);.                            var butikcode = getbutikcode(butikurl);.                            var butikcategory = menuurl.replace(""/"", string.empty);..                            //change butikendtime to datetime.                            timespan time = timespan.fromseconds(double.parse(butikendtime));.                            datetime butikdatetime = datetime.today.add(time);..                            //add values to datagrid.                            this.uithread(() =&gt; datagridview1.rows.add("""", ""markafoni"", butikcode, butikcategory, butiktitle, butikurl, butikimg, butikdatetime, ""pending""));..                            //add values to butikstable datatable for next level (insert products).                            butikstablemarkafoni.rows.add(butikcode, butikcategory, butiktitle, butikurl, butikimg, butikdatetime);..                        }.                    }.                    else.                    {.                        messagebox.show(""null obeject...! not found larg butiks"");.                    }.                    //***********end get campaign_big div of campaigns***********//...                    //***********start get campaign_medium div of campaigns***********//.                    htmlnodecollection campaignmedium = doc.documentnode.selectnodes(""//div[contains(@class,'campaign_medium')]"");.                    if (campaignmedium != null).                    {.                        foreach (htmlnode element in campaignmedium).                        {.                            //get butiks attribute values.                            var butikurl = element.selectsinglenode("".//a[@class='campaign-link-medium']"").getattributevalue(""href"", null);.                            var butiktitle = element.selectsinglenode("".//div[contains(@class,'campaign_name')]"").innertext;.                            var butikimg = element.selectsinglenode("".//img"").getattributevalue(""src"", null);.                            var butikendtime = element.selectsinglenode("".//div[contains(@class,'campaign_overlay_medium')]"").getattributevalue(""data-seconds"", null);.                            var butikcode = getbutikcode(butikurl);.                            var butikcategory = menuurl.replace(""/"", string.empty);..                            //change butikendtime to datetime.                            timespan time = timespan.fromseconds(double.parse(butikendtime));.                            datetime butikdatetime = datetime.today.add(time);..                            //add values to datagrid.                            this.uithread(() =&gt; datagridview1.rows.add("""", ""markafoni"", butikcode, butikcategory, butiktitle, butikurl, butikimg, butikdatetime, ""pending""));..                            //add values to butikstable datatable for next level (insert products).                            butikstablemarkafoni.rows.add(butikcode, butikcategory, butiktitle, butikurl, butikimg, butikdatetime);.                        }.                    }.                    else.                    {.                        //messagebox.show(""null obeject...! not found small butiks"");.                    }.                    //***********end get campaign_medium div of campaigns***********//..                    //increment counter after finish each thread.                    interlocked.increment(ref menucountermarkafoni);..                    //insert datatable to xs_butiks if all thread done...!.                    if (menulinksmarkafoni.count() == menucountermarkafoni).                    {.                        messagebox.show(butikstablemarkafoni.rows.count.tostring());.                        string sqlquery;.                        sqlquery = ""insert into xs_butiks (id,sitename,butikcode,butikcategory,butiktitle,butiklink,butikimglink,butikendtime,butikstatus) values (@id,@site,@code,@category,@title,@link,@imglink,@endtime,@status)"";..                        //open connection.                        con2.open();..                        foreach (datarow row in butikstablemarkafoni.rows).                        {.                            mysqlcommand cmd3 = new mysqlcommand(sqlquery, con2);.                            cmd3.commandtext = sqlquery;.                            cmd3.parameters.addwithvalue(""@id"", """");.                            cmd3.parameters.addwithvalue(""@site"", ""markafoni"");.                            cmd3.parameters.addwithvalue(""@code"", row[""butikcode""]);.                            cmd3.parameters.addwithvalue(""@category"", row[""butikcategory""]);.                            cmd3.parameters.addwithvalue(""@title"", row[""butiktitle""]);.                            cmd3.parameters.addwithvalue(""@link"", row[""butiklink""]);.                            cmd3.parameters.addwithvalue(""@imglink"", row[""butikimglink""]);.                            datetime date = datetime.parse(row[""butikendtime""].tostring());.                            cmd3.parameters.addwithvalue(""@endtime"", date);.                            cmd3.parameters.addwithvalue(""@status"", ""pending"");.                            cmd3.executenonquery();..                            /********************************************************************/..                            while (islockedmarkafonibutik) ;.                            task.factory.startnew(() =&gt;.                            {.                                getmarkafoniproducts(row, doc);.                            }.                            );.                            interlocked.increment(ref butikcountermarkafoni);.                            if (butikcountermarkafoni == 10) islockedmarkafonibutik = true;.                        }..                        //close connection.                        con2.close();.                    }..                });.            }.            //*********************end foreach menulink*******************//.        }.    }.    //**************************end level 1****************************//.    //.    //**************************start level 2****************************//.    private void getmarkafoniproducts(datarow row, htmlagilitypack.htmldocument doc).    {.        string butikurl = mainurlmarkafoni + row[""butiklink""];.        this.uithread(() =&gt; label1.text = butikurl);.        try.        {.            doc = webget.load(butikurl);..            //get category links from ul_category.            htmlnodecollection categorylinks = doc.documentnode.selectnodes(""//ul[contains(@class,'ul_category')]/li/a"");..            if (categorylinks != null).            {..                foreach (htmlnode link in categorylinks).                {.                    var categoryhref = link.getattributevalue(""href"",null);.                    var categorytitle = link.innertext;..                    if (!categoryhref.contains(""/all/"")).                    { .                        string categorylink = mainurlmarkafoni + categoryhref;.                        doc = webget.load(categorylink);.                        htmlnodecollection butikproducts = doc.documentnode.selectnodes(""//ul[@id='product_list']/li"");..                        if (butikproducts != null).                        {.                            foreach (htmlnode product in butikproducts).                            {.                                var producttitle = product.selectsinglenode("".//p[@class='bold product_name']/a"").getattributevalue(""title"", null);.                                var productsubtitle = string.empty; //don't exist in markafoni.                                var productlink = product.selectsinglenode("".//p[@class='bold product_name']/a"").getattributevalue(""href"", null);.                                var productimg = product.selectsinglenode("".//a/img"").getattributevalue(""src"", null);.                                var productcategory = categorytitle;.                                var productsize = string.empty;.                                var productbrand = string.empty;.                                var productstatus = product.getattributevalue(""data-sold"", null);.                                var productavailability = string.empty;.                                var productprice = product.getattributevalue(""data-price"", null);..                                //add values to datagrid.                                this.uithread(() =&gt; datagridview2.rows.add("""", ""markafoni"", row[""butikcode""], row[""butiklink""], row[""butikcategory""], row[""butikendtime""], producttitle, productsubtitle, productlink, productimg, productcategory, productsize, productbrand, productstatus, productavailability, productprice, ""pending""));..                                string sqlquery2;.                                sqlquery2 = ""insert into xs_butiks_products (product_id,sitename,butikcode,butiklink,butikcategory,butikendtime,producttitle,productsubtitle,productlink,productimglink,productcategory,productsize,productbrand,productstatus,productavailability,productprice,status) values (@id,@site,@bcode,@blink,@bcategory,@bendtime,@title,@subtitle,@plink,@pimglink,@pcategory,@size,@brand,@pstatus,@availability,@price,@status)"";.                                mysqlcommand cmd2 = new mysqlcommand(sqlquery2, con2);.                                cmd2.commandtext = sqlquery2;.                                cmd2.parameters.addwithvalue(""@id"", """");.                                cmd2.parameters.addwithvalue(""@site"", ""markafoni"");.                                cmd2.parameters.addwithvalue(""@bcode"", row[""butikcode""]);.                                cmd2.parameters.addwithvalue(""@blink"", row[""butiklink""]);.                                cmd2.parameters.addwithvalue(""@bcategory"", row[""butikcategory""]);.                                datetime date2 = datetime.parse(row[""butikendtime""].tostring());.                                cmd2.parameters.addwithvalue(""@bendtime"", date2);.                                cmd2.parameters.addwithvalue(""@title"", producttitle);.                                cmd2.parameters.addwithvalue(""@subtitle"", productsubtitle);.                                cmd2.parameters.addwithvalue(""@plink"", productlink);.                                cmd2.parameters.addwithvalue(""@pimglink"", productimg);.                                cmd2.parameters.addwithvalue(""@pcategory"", productcategory);.                                cmd2.parameters.addwithvalue(""@size"", productsize);.                                cmd2.parameters.addwithvalue(""@brand"", productbrand);.                                cmd2.parameters.addwithvalue(""@pstatus"", productstatus);.                                cmd2.parameters.addwithvalue(""@availability"", productavailability);.                                cmd2.parameters.addwithvalue(""@price"", productprice);.                                cmd2.parameters.addwithvalue(""@status"", ""pending"");.                                cmd2.executenonquery();.                                /**********/..                                //interlocked.increment(ref categorycountermarkafoni);.                            }.                        }.                    }.                }..            }..        }...    catch (exception ex).            {.                interlocked.decrement(ref butikcountermarkafoni);.                if (butikcountermarkafoni == 0) islockedmarkafonibutik = false;.                messagebox.show(ex.message);.            }..            interlocked.decrement(ref butikcountermarkafoni);.            if (butikcountermarkafoni == 0) islockedmarkafonibutik = false;.        }.private string getbutikcategory(string butikurl).        {.            string[] parts = butikurl.split('/');.            var item = parts.last();.            return item; .        }..        private string getbutikcode(string butikurl).        {.            string[] parts = butikurl.split('/');.            foreach (var item in parts).            {.                if (isnumeric(item)).                    return item;.            }..            return null;.        }..        public static bool isnumeric(object expression).        {.            double retnum;..            bool isnum = double.tryparse(convert.tostring(expression), system.globalization.numberstyles.any, system.globalization.numberformatinfo.invariantinfo, out retnum);.            return isnum;.        }...implementation of the code will be displayed and repeat the following errors. after a few minutes the following error code can be seen. but it did not stop code execution..i checked the code several times, but did not able to fix the problem. can anyone provide a little bit of time to fix this problem?...  there is already an open datareader associated whit this connection which must be closet first....and...  the request was aborted: the request was canceled."
