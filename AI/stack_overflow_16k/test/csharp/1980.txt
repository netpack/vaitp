"systemevents.sessionended is not being caught or fired please in my code i try to catch win32.systemevents.sessionended event to procede with saving of my app data by the end of session in case the app is not closed manually .. some time ago this has been workin and now that i had my project grown a lil it is not any more..? i have tried to find something meaningfull for few days but found nothing really.. when i try to catch another systemevent like monitorresolutionchanged it works well but this one not. i have also tried to register within the mainwindow (app form ..), nothing :-(    please any idea?.i think all the relevant information should be in the beginning till void main but i put it all in case you would need or want to see more .. thanx a lot  tomas .my code:..using system;.using system.collections.generic;.using system.windows.forms;.using system.threading;.using movablepython; // my own class within this project.using avn; //my own referenced assembly ..namespace dirdist.{.     class program.    {.        private static string appguid = ""cddbserviceman"";.        private static system.windows.forms.contextmenu nimenu;.        internal static system.windows.forms.notifyicon notifyicon1;.        private static menuitem showitem;.        public static menuitem justcdsitem;.        private static menuitem searchitem;.        private static menuitem settingsitem;.        private static menuitem quititem;..        internal static form1 mainwindow;.        private static hotkey hk;.        internal static registration.licencestate mode; // app mode - registered/trial/blocked/demaged ...        /// &lt;summary&gt;.        /// the main entry point for the application..        /// &lt;/summary&gt;.        [stathread].        static void main().        { .            using (mutex mutex = new mutex(false, appguid)).            {.                if (!mutex.waitone(0, false)).                {.                    messagebox.show(""cddb is already running on your machine n  (check status bar for access ..)"");.                    return;.                }.                gc.collect();..                application.enablevisualstyles();.                application.setcompatibletextrenderingdefault(false);..                mode = registration.startup();..                program.mainwindow = new form1();.                mainwindow.activate();.                //mainwindow.validate();.                //mainwindow.update();.                mainwindow.visible = false;.                puticon();..                //microsoft.win32.systemevents.sessionended += systemevents_sessionended;.                microsoft.win32.systemevents.sessionended += new microsoft.win32.sessionendedeventhandler(systemevents_sessionended);//**zkousime zda funguje pro hibernaci ...                registerhotkey(true);   .                application.run();.            }   .        }..        static void systemevents_sessionended(object sender, microsoft.win32.sessionendedeventargs e).        {.            //messagebox.show(""sessionended fired"");..            registerhotkey(false);..            notifyicon1.visible = false;.            notifyicon1.dispose();.            notifyicon1 = null;...            if (!mainwindow.dbsaved) mainwindow.savedb(form1.settings.dbpath);.            if (mainwindow.index != null) mainwindow.saveindex(form1.settings.indexpath);.            microsoft.win32.systemevents.sessionended -= new microsoft.win32.sessionendedeventhandler(systemevents_sessionended);.            mainwindow.close();.        }..        // zaregistruje globalni hotkey ctrl+shift+f pro hledani.        private static void registerhotkey(bool active).        {.            if (!active).            {.                if (hk != null) hk.unregister();.            }.            else.            {.                if(hk ==null) hk = new hotkey();..                hk.keycode = keys.f;.                //hk.windows = true;.                hk.shift = true;.                hk.control = true;.                //hk.pressed += delegate { console.writeline(""windows+1 pressed!""); };.                hk.pressed += delegate { searchitemclick(new object(), new eventargs()); };..                if (hk.getcanregister(mainwindow)) hk.register(mainwindow);.                else ; // just do nothing.            }.        }..        private static void puticon().        {.            if (notifyicon1 == null).            {   .                showitem = new menuitem (""&amp;show interface"", new system.eventhandler (showinfaceclick));.                justcdsitem = new menuitem (""&amp;jus'cds"",new system.eventhandler ( justcdsclick));.                justcdsitem.checked = form1.settings.justcds;.                searchitem = new menuitem(""search cddb"",new system.eventhandler (searchitemclick));.                searchitem.shortcut = shortcut.ctrlshiftf;.                searchitem.showshortcut = true;.                settingsitem = new menuitem(""settings"", new system.eventhandler(settingsitemclick));.                quititem = new menuitem(""&amp;quit"", new system.eventhandler(quititemclick));..                nimenu = new system.windows.forms.contextmenu(new menuitem[5] { showitem, justcdsitem, searchitem,settingsitem, quititem });...                notifyicon1 = new system.windows.forms.notifyicon();.                notifyicon1.contextmenu = nimenu;.                notifyicon1.icon = new system.drawing.icon(system.io.path.getdirectoryname(system.reflection.assembly.getexecutingassembly().location) + ""\icon1.ico"");.                //notifyicon1.icon = new system.drawing.icon(system.io.path.getdirectoryname( .                //system.reflection.assembly.getexecutingassembly().getname().codebase ) + ""icon1.ico"");.                //notifyicon1.icon = new system.drawing.icon(""icon1.ico"");.                notifyicon1.doubleclick += new eventhandler(notifyicon1_doubleclick);.                notifyicon1.visible = true;.            }.        }..        /* private static void notifyicon1_mousemove(object sender, mouseeventargs mea).         * aby to fungovalo je treba upravit contextmenu na contextmenustrip a taky ty items .. az nakonec.         * je tu kolem uz rozdelana priprava ...        {.            notifyicon1.showballoontip(2000,appname,""active"",tooltipicon.none);.        } */..        // clicks on notificationicon context menu ...        private static void showinfaceclick(object sender, eventargs e).        {.            mainwindow.tabcontrol1.selectedindex = 0;.            mainwindow.show();.        }..        private static void justcdsclick(object sender, eventargs e).        {.            form1.settings.justcds = mainwindow.checkbox1.checked = justcdsitem.checked = !form1.settings.justcds;.            if (mainwindow.visible) mainwindow.update();.        }..        private static void searchitemclick(object sender, eventargs e).        {.            mainwindow.tabcontrol1.selectedindex = 1 ;.            //this.size = new size(this.width, systeminformation.primarymonitorsize.height);.            mainwindow.location = new system.drawing.point(systeminformation.primarymonitorsize.width - mainwindow.width, systeminformation.primarymonitorsize.height - mainwindow.height);.            //mainwindow.location = new system.drawing.point(880, 500);.            mainwindow.show();.        }..        private static void settingsitemclick(object sender, eventargs e).        {.            mainwindow.tabpage3_gotfocus(new object(), new eventargs());.            mainwindow.tabcontrol1.selectedindex = 2;.            mainwindow.show();.        }..        public static void quititemclick(object sender, eventargs e).        {.            if (dialogresult.cancel == messagebox.show(""really exit application and stop scanning?"",form1.appname,messageboxbuttons.okcancel,messageboxicon.question)) return;.            if (!mainwindow.dbsaved) mainwindow.savedb(form1.settings.dbpath);.            //if (mainwindow.index != null) mainwindow.saveindex(form1.settings.indexpath);.            if (form1.settings.fileindex) mainwindow.saveindex(form1.settings.indexpath);.            mainwindow.close();.            mainwindow = null;.            notifyicon1.visible = false;.            application.exit();.        }..        static void notifyicon1_doubleclick(object sender, eventargs e).        {.            //throw new notimplementedexception();.            //if (!mainwindow.visible) mainwindow.windowstate = formwindowstate.normal; else mainwindow.windowstate = formwindowstate.minimized;.            //if (!mainwindow.visible) mainwindow.show(); else mainwindow.hide();.            if (!mainwindow.visible) mainwindow.visible = true; else mainwindow.visible = false;      .        }.    }.}"
