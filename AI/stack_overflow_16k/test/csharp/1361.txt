"how to prevent nc_calcsize from resizing my form? blank i'm creating a custom form (blank/windows forms/vista/windows7), and overriding wndproc to capture wm_ncpaint, wm_nccalcsize and wm_nchittest to draw a custom frame. i'm almost done with it but there is a problem that i could not work around myself. ..the problem is that nc_calcsize makes my form shrink when i restore it after its maximized. iÂ´ve googled it and found an answer from bob powell, and he stated that i neednt to handle nc_calcsize when wparam is true. after i've done that, wm_ncpaint had no effect anymore (it does handle the wm_ncpaint, but it does not paint the non-client area anymore, only after i invalidate it). ..so, resuming, when i handle wm_nccalcsize(wparam == true) it shrinks my form, when i dont, it doesnt paint anymore...has anyone had this problem before? if more code is needed i can provide it..tks...here's my wn_calcsize code:..private void wndprocnonclientcalcsize(ref message m).    {.        if (m.wparam == winapi.false).        {.            this.log(methodinfo.getcurrentmethod(), ""false"");..            winapi.nccalcsize_params csp;.            csp = (winapi.nccalcsize_params)marshal.ptrtostructure(m.lparam, typeof(winapi.nccalcsize_params));.            csp.rectproposed.top += this._nonclientheight;.            csp.rectproposed.bottom -= this._nonclientborderthickness;.            csp.rectproposed.left += this._nonclientborderthickness;.            csp.rectproposed.right -= this._nonclientborderthickness;.            marshal.structuretoptr(csp, m.lparam, false);.        }.        else if (m.wparam == winapi.true).        {.            this.log(methodinfo.getcurrentmethod(), ""true"");..            winapi.nccalcsize_params csp;.            csp = (winapi.nccalcsize_params)marshal.ptrtostructure(m.lparam, typeof(winapi.nccalcsize_params));.            csp.rectproposed.top += this._nonclientheight;.            csp.rectproposed.bottom -= this._nonclientborderthickness;.            csp.rectproposed.left += this._nonclientborderthickness;.            csp.rectproposed.right -= this._nonclientborderthickness;.            marshal.structuretoptr(csp, m.lparam, false);.        }..        m.result = winapi.true;.    }...here's my wm_ncpaint code:..private bool wndprocnonclientpaint(ref message m).    {.        this.log(methodinfo.getcurrentmethod(), string.empty);..        this.paintnonclient(m.hwnd, (intptr)m.wparam);.        m.result = winapi.true;.        return true;.    }..    private void paintnonclient(intptr hwnd, intptr hrgn).    {.        winapi.rect windowrect = new winapi.rect();.        winapi.getwindowrect(hwnd, ref windowrect);..        rectangle bounds = new rectangle(0, 0,.            windowrect.right - windowrect.left,.            windowrect.bottom - windowrect.top);..        if (bounds.width == 0 || bounds.height == 0).            return;..        region clipregion = new region(bounds);..        if (hrgn != (intptr)1).            clipregion = region.fromhrgn(hrgn);..        winapi.dcv dcv =.                winapi.dcv.window |.                winapi.dcv.intersectrgn |.                winapi.dcv.cache |.                winapi.dcv.clipsiblings;..        intptr hdc =.            winapi.getdcex(.                hwnd,.                hrgn,.                dcv);..        if (hdc == intptr.zero).            hdc = winapi.getwindowdc(hwnd);..        intptr compatiblehdc = winapi.createcompatibledc(hdc);.        intptr compatiblebitmap = winapi.createcompatiblebitmap(hdc, bounds.width, bounds.height);..        try.        {.            winapi.selectobject(compatiblehdc, compatiblebitmap);.            winapi.bitblt(compatiblehdc, 0, 0, bounds.width, bounds.height, hdc, 0, 0, winapi.srccopy);..            using (graphics g = graphics.fromhdc(compatiblehdc)).            {.                rectangle outteredge = new rectangle(0, 0, this.width, this.height);..                int x = this._nonclientborderthickness;.                int y = this._nonclientheight;.                int width = this.width - (this._nonclientborderthickness * 2);.                int height = this.height - this._nonclientborderthickness - this._nonclientheight;..                rectangle inneredge = new rectangle(x, y, width, height);..                graphicspath path = new graphicspath();..                path.addrectangle(outteredge);.                path.addrectangle(inneredge);..                using (solidbrush brush = new solidbrush(color.fromargb(45, 45, 48))).                    g.fillpath(brush, path);..                path.dispose();.            }..            winapi.bitblt(hdc, 0, 0, bounds.width, bounds.height, compatiblehdc, 0, 0, winapi.srccopy);.        }.        finally.        {.            winapi.deleteobject(compatiblebitmap);.            winapi.deletedc(compatiblehdc);.        }.    }"
