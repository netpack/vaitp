"how to schedule windows service daily once at 11am im running the windows service  which checks whether time is greater than 11am and if no record is present for that particular report type on that  date then data is inserted. timer is scheduled for every 10 minutes. is there any other alternative, as i feel there  is too much of database hit...it checks the emailnotificationsentlog table and if no record exists for that date and for that reporttype, data is inserted....sno   reporttype  createddate.1     daily        2015-05-29 11:00:07.683.2     daily        2015-06-01 11:00:08.317.3     daily        2015-06-02 11:17:56.890....procedure to check whether data is inserted or not...    createprocedure [dbo].[sp_get_emailnotificationsentlogexists]     .    (    .     @rpttype nvarchar(50)    .    )    .    as    .    begin    .     declare @time nvarchar(50)    .     declare @retval int     .     set @retval = 0    .     set @time = '11:00'    ..     if(convert(varchar(5), getdate(), 114) &gt;= @time)    .     begin    .        if not exists(select 1 from emailnotificationsentlog where ltrim(rtrim(reporttype)) = @rpttype    .      and  convert(date,createddate) = convert(date,getdate()))    .     begin       .      set @retval = 1    .        end    .     end    .     select @retval    ..    end ...procedure to insert record ..createprocedure [dbo].[sp_insert_emailnotificationsentlog]  .(  . @rpttype nvarchar(50)  .)  .as  .begin  .if not exists( select 1 from emailnotificationsentlog where reporttype = @rpttype .    and cast(createddate as date) = cast(getdate() as date)).begin.   insert into emailnotificationsentlog(reporttype,createddate)values (@rpttype,getdate()) .end .end  ...service class:..        public partial class service1 : servicebase.        {.            timer timer1 = new timer();.            sqlconnection objsqlcon = new  sqlconnection(configurationmanager.appsettings[""sqlconnection""].tostring());.            string objretval = string.empty;.            public service1().            {.                initializecomponent();.            }.        protected override void onstart(string[] args).        {..            timer1.interval = 600000; //10 mts.            timer1.enabled = true;.            timer1.elapsed += new system.timers.elapsedeventhandler(this.timer1_tick);.            timer1.enabled = true;.            writelog(""test windows service"");.        }.        private void timer1_tick(object sender,elapsedeventargs e).        {.            writelog(""test job done sucessfully"");.            // if time greater than 11 and if record doesnt exists.            objretval = retrievedata(reporttype.daily.tostring());.            if (objretval == ""1"").            {.                insertdata();.            }.            //onstop();.        }.        protected override void onstop().        {.            timer1.enabled = false;.            writelog(""test job stopped sucessfully"");.        }..        public string retrievedata(string strrpttype).        {.            string strretval = string.empty;.            try.            {.                sqlcommand cmd = new sqlcommand(""sp_get_emailnotificationsentlogexists"", objsqlcon);.                cmd.commandtype = commandtype.storedprocedure;.                cmd.parameters.addwithvalue(""@rpttype"", strrpttype);.                if (objsqlcon.state != connectionstate.open).                {.                    objsqlcon.open();.                }.                strretval = convert.tostring(cmd.executescalar());.                //l1.writelog(""data inserted successfully"");.            }.            catch (exception ex).            {.                //l1.writelog(ex.message.tostring());.                throw ex;.            }.            finally.            {.                objsqlcon.close();.            }.            return strretval;.        }..        void insertdata().        {.            try.            {.                sqlcommand cmd = new sqlcommand(""sp_insert_emailnotificationsentlog"", objsqlcon);.                cmd.commandtype = commandtype.storedprocedure;.                cmd.parameters.addwithvalue(""@rpttype"", reporttype.daily.tostring());.                if (objsqlcon.state != connectionstate.open).                {.                    objsqlcon.open();.                }.                cmd.executenonquery();.                writelog(""data inserted successfully"");.            }.            catch (exception ex).            {.                writelog(ex.message.tostring());.                throw ex;.            }.            finally.            {.                objsqlcon.close();.            }.        }..        public void writelog(string strmessage).        {.            string strlogdir = string.empty, strlogfilename = string.empty, sstrfilepath = string.empty;.            strlogdir = configurationmanager.appsettings[""logdirectory""].tostring();.            strlogfilename = configurationmanager.appsettings[""logname""].tostring();.            if (!directory.exists(strlogdir)).            {.                directory.createdirectory(strlogdir);.            }.            sstrfilepath = strlogdir + ""\"" + strlogfilename;.            if (!file.exists(sstrfilepath)).            {.                using (streamwriter sw = file.createtext(sstrfilepath)).                {.                    sw.writeline(""================================================================================"");.                    sw.writeline("" // "" + datetime.now.tostring());.                    sw.writeline(""message ttt: "" + strmessage);.                    sw.close();.                }.            }.            else.            {.                streamreader sreder = new streamreader(sstrfilepath);.                string oldtext = sreder.readtoend();.                sreder.close();.                streamwriter swriter = new streamwriter(sstrfilepath);.                swriter.writeline(oldtext);.                swriter.writeline(""================================================================================"");.                swriter.writeline("" // "" + datetime.now.tostring());.                swriter.writeline(""file name ttt: "" + strmessage);.                swriter.close();.            }.        }..        enum reporttype {daily,monthly,yearly}..    }"
