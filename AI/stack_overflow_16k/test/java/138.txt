"how to suppress the file corrupt warning at csvdownload? i have a web page which links to an excel 2007 worksheet. it is a upload details in .xlsx file and download in .csv file. when i click on the download link  and trying to open i get the usual dialog box to either open/save the excel file. on clicking 'open', i get the following warning message-...  the file you are trying to open, 'filename.csv' is in a different format than specified by the file extension. verify that the file is not corrupted and is from a trusted source before opening the file. do you want to open the file now?...i developed this code in blank..private void downloadexcelsheet(hssfworkbook workbook, string sheetname){.    outputstream out = null;.    try{..        bytearrayoutputstream outbytestream = new bytearrayoutputstream();.        workbook.write(outbytestream);.        byte[] bytes = outbytestream.tobytearray(); //workbook.getbytes().        httpservletresponse response = (httpservletresponse) facescontext.getcurrentinstance().getexternalcontext().getresponse();..        response.reset();.        string disheader = ""attachment;filename=""""+sheetname+"".csv"""";.        response.addheader(""content-disposition"", disheader);.        response.setcontenttype(""text/csv"");.        //response.setheader(""content-disposition"", ""attachment; filename=""""+sheetname+"".csv"");.        //response.setcontenttype(""text/csv"");.        response.setcontentlength(bytes.length);.        out = response.getoutputstream();.        out.write(bytes);.        out.flush();..    }catch(ioexception ioe){.        ioe.printstacktrace();.    }.    catch(exception e){.        e.printstacktrace();.    }.    finally{.        try{.            if(out!=null){.                out.close();.            }.        }catch(ioexception io){.            io.printstacktrace();.        }.    }.}"
