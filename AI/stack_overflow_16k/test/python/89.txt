"counting rows with nan i have the following dataframe: ..dur  wage1  wage2  wage3  cola  hours     pension  stby_pay  shift_diff.6   3.0    2.0    3.0    nan   tcf    nan  empl_contr       nan         nan.8   1.0    2.8    nan    nan  none   38.0  empl_contr       2.0         3.0.9   1.0    5.7    nan    nan  none   40.0  empl_contr       nan         4.0.13  1.0    5.7    nan    nan  none   40.0  empl_contr       nan         4.0.17  3.0    2.0    3.0    nan   tcf    nan  empl_contr       nan         nan.31  1.0    5.7    nan    nan  none   40.0  empl_contr       nan         4.0.43  2.0    2.5    3.0    nan   nan   40.0        none       nan         nan.44  1.0    2.8    nan    nan  none   38.0  empl_contr       2.0         3.0.47  3.0    2.0    3.0    nan   tcf    nan  empl_contr       nan         nan...what i have to do is count the rows that are exactly the same, including the nan values...the problem is the following, i use groupby, but it is a function that ignores the nan values, that is, it does not have them in mind when doing the counting, that is the reason why i am not returning a correct output counting the number of exact repetitions between those rows...my code is the following one:..def detect_duplicates(data):.    x = dataframe(columns=data.columns.tolist() + [""num_reps""])..    aux = data[data.duplicated(keep=false)].    x = data[data.duplicated(keep=false)].drop_duplicates().    #this line should count my repeated rows.    s = aux.groupby(data.columns.tolist(),as_index=false).transform('size')...    return x...if i print ""x"" var, i get this result, it shows all the repeated rows: ..dur  wage1  wage2  wage3  cola  hours     pension  stby_pay  shift_diff.6   3.0    2.0    3.0    nan   tcf    nan  empl_contr       nan         nan.8   1.0    2.8    nan    nan  none   38.0  empl_contr       2.0         3.0.9   1.0    5.7    nan    nan  none   40.0  empl_contr       nan         4.0.13  1.0    5.7    nan    nan  none   40.0  empl_contr       nan         4.0.17  3.0    2.0    3.0    nan   tcf    nan  empl_contr       nan         nan.31  1.0    5.7    nan    nan  none   40.0  empl_contr       nan         4.0.43  2.0    2.5    3.0    nan   nan   40.0        none       nan         nan.44  1.0    2.8    nan    nan  none   38.0  empl_contr       2.0         3.0.47  3.0    2.0    3.0    nan   tcf    nan  empl_contr       nan         nan.51  3.0    2.0    3.0    nan   tcf    nan  empl_contr       nan         nan.53  2.0    2.5    3.0    nan   nan   40.0        none       nan         nan...now i have to count those rows from my x result that are exactly the same...this should be my correct output:.. dur    wage1   wage2   wage3   cola    hours   pension stby_pay    shift_diff  num_reps.6   3.0 2.0 3.0 nan tcf nan empl_contr  nan nan                4.8   1.0 2.8 nan nan none    38.0    empl_contr  2.0 3.0        2.9   1.0 5.7 nan nan none    40.0    empl_contr  nan 4.0        3.43  2.0 2.5 3.0 nan nan 40.0    none    nan nan                2...here is my problem and it's that groupby ignores nan values, and that's why other similar posts about this problem can't help me...thanks"
