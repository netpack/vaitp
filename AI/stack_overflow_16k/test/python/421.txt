"blank - to output contents in a html file to spreadsheet part of below is sourced from another example. it’s modified a bit and use to read a html file, and output the contents into a spreadsheet...as it’s a just a local file, using selenium is maybe an over-kill, but i just want to learn through this example...from selenium import webdriver.import lxml.html as lh.import lxml.html.clean as clean.import xlwt..book = xlwt.workbook(encoding='utf-8', style_compression = 0).sheet = book.add_sheet('seaweb', cell_overwrite_ok = true)..driver = webdriver.phantomjs().ignore_tags=('script','noscript','style')..results = []..driver.get(""source_file.html"").content = driver.page_source.cleaner = clean.cleaner().content = cleaner.clean_html(content).doc = lh.fromstring(content)..for elt in doc.iterdescendants():.    if elt.tag in ignore_tags: continue.    text = elt.text or ''                                 #question 1.    tail = elt.tail or ''                                 #question 1.    words = ''.join((text,tail)).strip().    if words:                                   # extra question.        words = words.encode('utf-8')                     #question 2.        results.append(words)                             #question 3.        results.append('; ')                              #question 3..sheet.write (0, 0, results)..book.save(""c:\ source_output.xls"")....the lines text=elt.text or '' and tail=elt.tail or '' – why both .text and .tail have texts? and why the or '' part is important here?.the texts in the html file contains special characters like ° (temperature degrees) – the .encode('utf-8') doesn’t make it a perfect output, neither in idle or excel spreadsheet. what’s the alternative?.is it possible to join the output into a string, instead of a list? now to append it into a list, i have to .append it twice to have the texts and ; added."
