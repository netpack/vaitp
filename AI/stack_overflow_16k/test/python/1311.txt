"attributeerror: __exit__ error even though email is sent i am trying to only send the email when excel file is non empty (there is data beyond the header), and do nothing otherwise..this is probably something stupid i am overlooking, but the query below is throwing an attributeerror: __exit__ error. i thought the with statement should have taken care of that (f.close())...would you mind checking what's wrong please? thank you!.please note that regardless of the error, the email is actually sent, but the message in the else statement is not printed.  ..with xlrd.open_workbook('name.xlsx').sheet_by_index(0) as f:.    if len(f.readlines()) &gt; 1:  .        insert script to send email # if excel is not empty, send output via email.    else:.        print('no new data') # dont send email"
